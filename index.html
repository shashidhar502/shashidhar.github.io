<!DOCTYPE html>
<html>
<body>

<h2>Using the XMLHttpRequest Object</h2>

<p id="demo"></p>
<a href="microsoft-edge:https://www.example.com">Open in Edge</a>
<button type="button" onclick="loadasync()">Agent app async</button>
<button type="button" onclick="loadsync()">Agent app sync</button>
<button type="button" onclick="loadTest()"> Test Agent app full url</button>
</div>

<div style=margin-top:20px;>
<button type="button" onclick="loadRequestasync()">Requestor app async</button>
<button type="button" onclick="loadRequestsync()">Requestor app sync</button>
</div>

<script>
//$(document).ready(function() { window.location="https://httpbin.org/redirect-to?url=snappauth%3A%2F%2F"; })
function loadasync(){
document.getElementById("demo").innerHTML = "loading async...";
	setTimeout(function() { loadasync_internal(); }, 3000);
}
function loadasync_internal() {
const myPromise = new Promise(function(myResolve, myReject) {
   myResolve("https://httpbin.org/redirect-to?url=snappauth%3A%2F%2F"); 
});

myPromise.then(function(value) {
	document.getElementById("demo").innerHTML = "loading async triggered...";
  window.location.href = value;
});

}
function loadsync() {
  document.getElementById("demo").innerHTML = "loading synchronously...";
	window.location.href = "https://httpbin.org/redirect-to?url=snappauth%3A%2F%2F"
  
}

function loadTest() {
  document.getElementById("demo").innerHTML = "loading synchronously...";
	window.location.href = "https://httpbin.org/redirect-to?url=snappauth%3A%2F%2F&client_id=ff97fbb4da3313004591cc3a291b47fd&response_type=code&state=JKpAaFoslM-WpS_1WUK03w&nonce=oPt7AZQtFiLSjtqt0q5uSg&code_challenge=N_LZ90sqbwwqim_YFJFa7fs4RJtObRXEzbqdwn3s-9Q&code_challenge_method=S256&logoutfirst=false"
  
}


function loadRequestasync(){
document.getElementById("demo").innerHTML = "loading async...";
	setTimeout(function() { loadRequestasync_internal(); }, 3000);
}
function loadRequestasync_internal() {
const myPromise1 = new Promise(function(myResolve, myReject) {
   myResolve("https://httpbin.org/redirect-to?url=snempappauth%3A%2F%2F"); 
});

myPromise1.then(function(value) {
	document.getElementById("demo").innerHTML = "loading async triggered...";
  window.location.href = value;
});

}
function loadRequestsync() {
  document.getElementById("demo").innerHTML = "loading synchronously...";
	window.location.href = "https://httpbin.org/redirect-to?url=snempappauth%3A%2F%2F"
  
}
</script>

</body>
</html>
